---
sidebar: sidebar 
permalink: prev-ontap-restore-browse.html 
keywords: backing up, back up, backup, backup application data, Amazon Web services, AWS, NetApp Backup and Recovery, Oracle database, Microsoft SQL Server database, SAP HANA database 
summary: NetApp Backup and Recoveryでは、Browse & Restore を使用してONTAPデータを復元します。 
---
= 参照と復元を使用してONTAPデータを復元する
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
NetApp Backup and Recoveryでは、Browse & Restore を使用してONTAPデータを復元します。復元する前に、ソース ボリューム名、ソース システムと SVM、およびバックアップ ファイルの日付をメモします。スナップショット、複製されたボリューム、またはオブジェクト ストレージに保存されたバックアップからONTAPデータを復元できます。

復元機能はONTAP のバージョンによって異なります。

* *フォルダ:* ONTAP 9.13.0 以降を使用すると、すべてのファイルとサブフォルダを含むフォルダを復元できます。それ以前のバージョンでは、フォルダ内のファイルのみを復元できます。
* *アーカイブ ストレージ:* アーカイブ ストレージ ( ONTAP 9.10.1 以降で利用可能) からの復元は遅くなり、追加コストが発生する可能性があります。
* *宛先クラスタの要件:*
+
** ボリュームリストア: ONTAP 9.10.1 以上
** ファイル復元: ONTAP 9.11.1 以上
** Google Archive およびStorageGRID: ONTAP 9.12.1 以上
** フォルダの復元: ONTAP 9.13.1 以上




link:prev-reference-aws-archive-storage-tiers.html["AWSアーカイブストレージからの復元の詳細"]。link:prev-reference-azure-archive-storage-tiers.html["Azure アーカイブ ストレージからの復元の詳細"]。link:prev-reference-gcp-archive-storage-tiers.html["Google アーカイブ ストレージからの復元の詳細"]。


NOTE: Azure アーカイブ ストレージからStorageGRIDシステムにデータを復元する場合、高優先度はサポートされません。



== サポートされているシステムとオブジェクト ストレージ プロバイダーを参照および復元する

セカンダリ システム (複製されたボリューム) またはオブジェクト ストレージ (バックアップ ファイル) にあるバックアップ ファイルから、次のシステムにONTAPデータを復元できます。スナップショットはソース システム上に存在し、同じシステムにのみ復元できます。

*注:* ボリュームはどのタイプのバックアップ ファイルからでも復元できますが、現時点では、フォルダーまたは個々のファイルはオブジェクト ストレージ内のバックアップ ファイルからのみ復元できます。

[cols="25,25,25,25"]
|===
| *オブジェクトストアから（バックアップ）* | *プライマリから（スナップショット）* | *セカンダリシステムから（レプリケーション）* | 宛先システムへ 


| Amazon S3 | AWS オンプレミスONTAPシステムのCloud Volumes ONTAP | AWS オンプレミスONTAPシステムのCloud Volumes ONTAP | Azure ブロブ 


| Azure のCloud Volumes ONTAPオンプレミスONTAPシステム | Azure のCloud Volumes ONTAPオンプレミスONTAPシステム | Google Cloud Storage | Google オンプレミスONTAPシステムのCloud Volumes ONTAP 


| Google オンプレミスONTAPシステムのCloud Volumes ONTAP | NetAppStorageGRID | オンプレミスのONTAPシステム | オンプレミスのONTAPシステムCloud Volumes ONTAP 


| オンプレミスのONTAPシステムへ | ONTAP S3 | オンプレミスのONTAPシステム | オンプレミスのONTAPシステムCloud Volumes ONTAP 
|===
参照と復元の場合、コンソール エージェントは次の場所にインストールできます。

* Amazon S3の場合、コンソールエージェントはAWSまたはオンプレミスに導入できます。
* Azure Blobの場合、コンソールエージェントはAzureまたはオンプレミスに展開できます。
* Google Cloud Storage の場合、コンソール エージェントを Google Cloud Platform VPC にデプロイする必要があります。
* StorageGRIDの場合、コンソールエージェントは、インターネットアクセスの有無にかかわらず、お客様の敷地内に導入する必要があります。
* ONTAP S3の場合、コンソールエージェントは、オンプレミス（インターネットアクセスの有無にかかわらず）またはクラウドプロバイダー環境に導入できます。


「オンプレミスのONTAPシステム」への参照には、 FAS、 AFF、およびONTAP Selectシステムが含まれることに注意してください。


NOTE: システムのONTAPバージョンが 9.13.1 未満の場合、バックアップ ファイルが DataLock & Ransomware で構成されていると、フォルダーまたはファイルを復元できません。この場合、バックアップ ファイルからボリューム全体を復元し、必要なファイルにアクセスできます。



== 参照と復元を使用してボリュームを復元する

バックアップ ファイルからボリュームを復元すると、 NetApp Backup and Recovery はバックアップのデータを使用して新しいボリュームを作成します。オブジェクト ストレージからのバックアップを使用すると、データを元のシステムのボリューム、ソース システムと同じクラウド アカウントにある別のシステム、またはオンプレミスのONTAPシステムに復元できます。

ONTAP 9.13.0 以降を使用しているCloud Volumes ONTAPシステム、またはONTAP 9.14.1 を実行しているオンプレミスのONTAPシステムにクラウド バックアップを復元する場合は、_クイック リストア_ 操作を実行するオプションがあります。クイック リストアは、ボリュームへのアクセスをできるだけ早く提供する必要がある災害復旧の状況に最適です。クイック リストアでは、バックアップ ファイル全体を復元するのではなく、バックアップ ファイルからボリュームにメタデータを復元します。クイック リストアは、パフォーマンスや待ち時間が重要となるアプリケーションには推奨されません。また、アーカイブ ストレージ内のバックアップではサポートされません。


NOTE: クイック リストアは、クラウド バックアップが作成されたソース システムでONTAP 9.12.1 以降が実行されている場合にのみ、 FlexGroupボリュームに対してサポートされます。また、ソース システムでONTAP 9.11.0 以降が実行されている場合にのみ、 SnapLockボリュームでサポートされます。

複製されたボリュームから復元する場合、ボリュームを元のシステム、 Cloud Volumes ONTAPまたはオンプレミスのONTAPシステムに復元できます。

image:diagram_browse_restore_volume.png["参照と復元を使用してボリューム復元操作を実行するフローを示す図。"]

ボリュームを復元するには、ソース システム名、ストレージ VM、ボリューム名、およびバックアップ ファイルの日付が必要です。

.手順
. コンソール メニューから、*保護 > バックアップとリカバリ* を選択します。
. *復元*タブを選択すると、復元ダッシュボードが表示されます。
. [参照と復元] セクションから、[ボリュームの復元] を選択します。
. [_ソースの選択_] ページで、復元するボリュームのバックアップ ファイルに移動します。復元する日付/タイムスタンプを持つ *システム*、*ボリューム*、および *バックアップ* ファイルを選択します。
+
*場所* 列には、バックアップ ファイル (スナップショット) が *ローカル* (ソース システム上のスナップショット)、*セカンダリ* (セカンダリONTAPシステム上の複製されたボリューム)、または *オブジェクト ストレージ* (オブジェクト ストレージ内のバックアップ ファイル) のいずれであるかが表示されます。復元するファイルを選択します。

. *次へ*を選択します。
+
オブジェクト ストレージ内のバックアップ ファイルを選択し、そのバックアップに対してランサムウェア耐性がアクティブになっている場合 (バックアップ ポリシーで DataLock とランサムウェア耐性を有効にした場合)、データを復元する前に、バックアップ ファイルに対して追加のランサムウェア スキャンを実行するように求められます。バックアップ ファイルをランサムウェアのスキャン対象とすることをお勧めします。  (バックアップ ファイルの内容にアクセスするには、クラウド プロバイダーから追加の送信コストが発生します。)

. [_宛先の選択_] ページで、ボリュームを復元する *システム* を選択します。
. オブジェクト ストレージからバックアップ ファイルを復元するときに、オンプレミスのONTAPシステムを選択し、オブジェクト ストレージへのクラスタ接続をまだ構成していない場合は、追加情報の入力を求められます。
+
** Amazon S3 から復元する場合は、宛先ボリュームが存在するONTAPクラスター内の IPspace を選択し、作成したユーザーのアクセス キーとシークレット キーを入力してONTAPクラスターに S3 バケットへのアクセス権を付与し、オプションで安全なデータ転送のためにプライベート VPC エンドポイントを選択します。
** Azure Blob から復元する場合は、宛先ボリュームが存在するONTAPクラスター内の IPspace を選択し、オブジェクト ストレージにアクセスするための Azure サブスクリプションを選択し、オプションで VNet とサブネットを選択して、安全なデータ転送のためのプライベート エンドポイントを選択します。
** Google Cloud Storage から復元する場合は、Google Cloud プロジェクトとアクセス キーおよびシークレット キーを選択して、オブジェクト ストレージ、バックアップが保存されるリージョン、および宛先ボリュームが存在するONTAPクラスター内の IPspace にアクセスします。
** StorageGRIDから復元する場合は、 StorageGRIDサーバーの FQDN と、 ONTAP がStorageGRIDとの HTTPS 通信に使用するポートを入力し、オブジェクト ストレージにアクセスするために必要なアクセス キーとシークレット キー、および宛先ボリュームが存在するONTAPクラスタ内の IPspace を選択します。
** ONTAP S3 からリストアする場合は、 ONTAP S3 サーバーの FQDN と、 ONTAP がONTAP S3 との HTTPS 通信に使用するポートを入力し、オブジェクト ストレージにアクセスするために必要なアクセス キーとシークレット キー、および宛先ボリュームが存在するONTAPクラスター内の IPspace を選択します。


. 復元されたボリュームに使用する名前を入力し、ボリュームが保存されるストレージ VM とアグリゲートを選択します。 FlexGroupボリュームを復元する場合は、複数のアグリゲートを選択する必要があります。デフォルトでは、ボリューム名として *<source_volume_name>_restore* が使用されます。
+
オブジェクト ストレージからONTAP 9.13.0 以上を使用するCloud Volumes ONTAPシステム、またはONTAP 9.14.1 を実行するオンプレミスのONTAPシステムにバックアップを復元する場合は、クイック復元操作を実行するオプションがあります。

+
また、アーカイブ ストレージ層 ( ONTAP 9.10.1 以降で利用可能) にあるバックアップ ファイルからボリュームを復元する場合は、復元優先度を選択できます。

+
link:prev-reference-aws-archive-storage-tiers.html["AWSアーカイブストレージからの復元の詳細"]。link:prev-reference-azure-archive-storage-tiers.html["Azure アーカイブ ストレージからの復元の詳細"]。link:prev-reference-gcp-archive-storage-tiers.html["Google アーカイブ ストレージからの復元の詳細"]。Google アーカイブ ストレージ層のバックアップ ファイルはほぼ即座に復元されるため、復元の優先順位は必要ありません。

. [次へ] を選択して、通常の復元プロセスを実行するか、クイック復元プロセスを実行するかを選択します。
+
** *通常の復元*: 高いパフォーマンスが必要なボリュームでは通常の復元を使用します。復元プロセスが完了するまでボリュームは使用できません。
** *クイック復元*: 復元されたボリュームとデータはすぐに利用できるようになります。クイック リストア プロセス中はデータへのアクセスが通常よりも遅くなる可能性があるため、高パフォーマンスが必要なボリュームではこれを使用しないでください。


. *復元*を選択すると、復元ダッシュボードに戻り、復元操作の進行状況を確認できます。


.結果
NetApp Backup and Recovery は、選択したバックアップに基づいて新しいボリュームを作成します。

アーカイブ ストレージにあるバックアップ ファイルからボリュームを復元する場合、アーカイブ層と復元の優先度に応じて数分から数時間かかる場合があることに注意してください。復元の進行状況を確認するには、[*ジョブ監視*] タブを選択します。



== 参照と復元を使用してフォルダとファイルを復元する

ONTAPボリューム バックアップから少数のファイルのみを復元する必要がある場合は、ボリューム全体を復元するのではなく、フォルダーまたは個々のファイルを復元することを選択できます。フォルダーとファイルを元のシステムの既存のボリュームに復元することも、同じクラウド アカウントを使用している別のシステムに復元することもできます。オンプレミスのONTAPシステム上のボリュームにフォルダーとファイルを復元することもできます。


NOTE: 現時点では、オブジェクト ストレージ内のバックアップ ファイルからのみフォルダーまたは個々のファイルを復元できます。現在、ローカル スナップショットまたはセカンダリ システム (複製されたボリューム) にあるバックアップ ファイルからのファイルとフォルダーの復元はサポートされていません。

複数のファイルを選択した場合、それらは同じ宛先ボリュームに復元されます。ファイルを別のボリュームに復元するには、プロセスを複数回実行します。

ONTAP 9.13.0 以降を使用している場合は、フォルダーとその中のすべてのファイルおよびサブフォルダーを復元できます。  9.13.0 より前のバージョンのONTAPを使用する場合、そのフォルダのファイルのみが復元され、サブフォルダまたはサブフォルダ内のファイルは復元されません。

[NOTE]
====
* バックアップ ファイルに DataLock および Ransomware 保護が設定されている場合、 ONTAPバージョンが 9.13.1 以上の場合にのみフォルダー レベルの復元がサポートされます。以前のバージョンのONTAPを使用している場合は、バックアップ ファイルからボリューム全体を復元し、必要なフォルダーとファイルにアクセスできます。
* バックアップ ファイルがアーカイブ ストレージに存在する場合、 ONTAPバージョンが 9.13.1 以上の場合にのみ、フォルダー レベルの復元がサポートされます。以前のバージョンのONTAPを使用している場合は、アーカイブされていない新しいバックアップ ファイルからフォルダを復元するか、アーカイブされたバックアップからボリューム全体を復元して、必要なフォルダとファイルにアクセスすることができます。
* ONTAP 9.15.1 では、「参照と復元」オプションを使用してFlexGroupフォルダを復元できます。この機能はテクノロジープレビュー モードです。
+
特別なフラグを使用してテストすることができます。 https://community.netapp.com/t5/Tech-ONTAP-Blogs/BlueXP-Backup-and-Recovery-July-2024-Release/ba-p/453993#toc-hId-1830672444["NetApp Backup and Recovery2024 年 7 月リリース ブログ"^] 。



====


=== フォルダとファイルを復元する

ONTAPボリューム バックアップからボリュームにフォルダーまたはファイルを復元するには、次の手順に従います。フォルダーまたはファイルを復元するために使用するボリュームの名前とバックアップ ファイルの日付を知っておく必要があります。この機能はライブ ブラウジングを使用するため、各バックアップ ファイル内のディレクトリとファイルのリストを表示できます。

image:diagram_browse_restore_file.png["参照と復元を使用してファイルの復元操作を実行するフローを示した図。"]

.開始する前に
* _ファイル_復元操作を実行するには、 ONTAPバージョンが 9.6 以上である必要があります。
* フォルダの復元操作を実行するには、 ONTAPバージョンが 9.11.1 以上である必要があります。データがアーカイブ ストレージにある場合、またはバックアップ ファイルで DataLock およびランサムウェア保護が使用されている場合は、 ONTAPバージョン 9.13.1 が必要です。
* 参照と復元オプションを使用してFlexGroupディレクトリを復元するには、 ONTAPバージョンが 9.15.1 p2 以上である必要があります。


.手順
. コンソール メニューから、*保護 > バックアップとリカバリ* を選択します。
. *復元*タブを選択すると、復元ダッシュボードが表示されます。
. [参照と復元] セクションで、[ファイルまたはフォルダーの復元] を選択します。
. [_ソースの選択_] ページで、復元するフォルダーまたはファイルが含まれているボリュームのバックアップ ファイルに移動します。ファイルを復元する日付/タイムスタンプを持つ *システム*、*ボリューム*、および *バックアップ* を選択します。
. [次へ] を選択すると、ボリューム バックアップのフォルダーとファイルのリストが表示されます。
+
アーカイブ ストレージ層にあるバックアップ ファイルからフォルダーまたはファイルを復元する場合は、復元の優先順位を選択できます。

+
link:prev-reference-aws-archive-storage-tiers.html["AWSアーカイブストレージからの復元の詳細"]。link:prev-reference-azure-archive-storage-tiers.html["Azure アーカイブ ストレージからの復元の詳細"]。link:prev-reference-gcp-archive-storage-tiers.html["Google アーカイブ ストレージからの復元の詳細"]。Google アーカイブ ストレージ層のバックアップ ファイルはほぼ即座に復元されるため、復元の優先順位は必要ありません。

+
また、バックアップ ファイルに対して Ransomware Resilience がアクティブになっている場合 (バックアップ ポリシーで DataLock と Ransomware Resilience を有効にした場合)、データを復元する前に、バックアップ ファイルに対して追加のランサムウェア スキャンを実行するように求められます。バックアップ ファイルをランサムウェアのスキャン対象とすることをお勧めします。  (バックアップ ファイルの内容にアクセスするには、クラウド プロバイダーから追加の送信コストが発生します。)

. [_アイテムの選択_] ページで、復元するフォルダーまたはファイルを選択し、[続行] を選択します。アイテムを見つける際に役立つ情報:
+
** フォルダーまたはファイル名が表示されている場合はそれを選択できます。
** 検索アイコンを選択し、フォルダーまたはファイルの名前を入力すると、アイテムに直接移動できます。
** 行の末尾にある下矢印を使用してフォルダー内の下のレベルに移動し、特定のファイルを見つけることができます。
+
ファイルを選択すると、ページの左側に追加されるので、すでに選択したファイルを確認できます。必要に応じて、ファイル名の横にある *x* を選択して、このリストからファイルを削除できます。



. [_宛先の選択_] ページで、アイテムを復元する *システム* を選択します。
+
オンプレミス クラスターを選択し、オブジェクト ストレージへのクラスター接続をまだ構成していない場合は、追加情報の入力を求められます。

+
** Amazon S3 から復元する場合は、宛先ボリュームが存在するONTAPクラスターの IPspace と、オブジェクト ストレージにアクセスするために必要な AWS アクセス キーとシークレット キーを入力します。クラスターへの接続にプライベート リンク構成を選択することもできます。
** Azure Blob から復元する場合は、宛先ボリュームが存在するONTAPクラスター内の IPspace を入力します。クラスターへの接続にプライベート エンドポイント構成を選択することもできます。
** Google Cloud Storage から復元する場合は、宛先ボリュームが存在するONTAPクラスター内の IPspace と、オブジェクト ストレージにアクセスするために必要なアクセス キーとシークレット キーを入力します。
** StorageGRIDから復元する場合は、 StorageGRIDサーバーの FQDN と、 ONTAP がStorageGRIDとの HTTPS 通信に使用するポートを入力し、オブジェクト ストレージにアクセスするために必要なアクセス キーとシークレット キー、および宛先ボリュームが存在するONTAPクラスタ内の IPspace を入力します。


. 次に、フォルダーまたはファイルを復元する *ボリューム* と *フォルダー* を選択します。
+
フォルダーやファイルを復元する際の場所についてはいくつかのオプションがあります。

+
** 上記のように*ターゲットフォルダーの選択*を選択した場合:
+
*** 任意のフォルダを選択できます。
*** フォルダーの上にマウスを移動し、行の末尾をクリックしてサブフォルダーにドリルダウンし、フォルダーを選択できます。


** ソース フォルダ/ファイルが配置されていたのと同じ宛先システムとボリュームを選択した場合は、[*ソース フォルダ パスを維持*] を選択して、フォルダまたはファイルをソース構造に存在していたのと同じフォルダに復元できます。同じフォルダーとサブフォルダーがすべてすでに存在している必要があります。フォルダーは作成されません。ファイルを元の場所に復元する場合、ソース ファイルを上書きするか、新しいファイルを作成するかを選択できます。


. *復元* を選択して復元ダッシュボードに戻り、復元操作の進行状況を確認します。

