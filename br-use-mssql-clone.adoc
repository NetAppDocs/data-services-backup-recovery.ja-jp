---
sidebar: sidebar 
permalink: br-use-mssql-clone.html 
keywords: backing up, restoring, back up, backup, clone, restore, cloud volumes ontap, aws, azure, s3, blob, google cloud, storagegrid, back up volumes, cloud backup, restore volumes, cost, on-premises ontap, onprem, applications, virtual machines, backup and recovery 
summary: 開発、テスト、または保護の目的で、Microsoft SQL Server アプリケーション データを複製します。  Microsoft SQL Server ワークロードのインスタント スナップショットまたは既存のスナップショットからクローンを作成できます。 
---
= NetApp のバックアップとリカバリを使用して Microsoft SQL Server ワークロードをクローンする
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
NetApp Backup and Recovery を使用して、開発、テスト、または保護の目的で、Microsoft SQL Server アプリケーション データを同じまたは別の VM に複製します。  Microsoft SQL Server ワークロードのインスタント スナップショットまたは既存のスナップショットからクローンを作成できます。

次のクローンの種類から選択します。

* *インスタント スナップショットとクローン*: インスタント スナップショットから Microsoft SQL Server ワークロードのクローンを作成できます。インスタント スナップショットは、バックアップから作成されたソース データの特定時点のコピーです。クローンは、パブリック クラウド アカウントまたはプライベート クラウド アカウントのオブジェクト ストアに保存されます。データが失われたり破損したりした場合に、クローンを使用してワークロードを復元できます。
* *既存のスナップショットからのクローン作成*: ワークロードで使用可能なスナップショットのリストから既存のスナップショットを選択できます。このオプションは、特定の時点からクローンを作成する場合に便利です。プライマリ ストレージまたはセカンダリ ストレージにクローンを作成します。


次の保護目標を達成できます。

* クローンを作成する
* クローンの更新
* クローンのスプリット
* クローンを削除する


*必要なNetAppコンソール ロール* ストレージ ビューアー、バックアップおよびリカバリ スーパー管理者、またはバックアップおよびリカバリ バックアップ管理者ロール。 https://docs.netapp.com/us-en/console-setup-admin/reference-iam-predefined-roles.html["すべてのサービスに対するNetAppコンソールのアクセスロールについて学習します"^] 。



== クローンを作成する

Microsoft SQL Server ワークロードのクローンを作成できます。クローンとは、バックアップから作成されたソース データのコピーです。クローンは、パブリック クラウド アカウントまたはプライベート クラウド アカウントのオブジェクト ストアに保存されます。データが失われたり破損したりした場合に、クローンを使用してワークロードを復元できます。

既存のスナップショットまたはインスタント スナップショットからクローンを作成できます。インスタント スナップショットは、バックアップから作成されたソース データの特定時点のコピーです。データが失われたり破損したりした場合に、クローンを使用してワークロードを復元できます。

.手順
. NetApp のバックアップとリカバリ メニューから、*クローン* を選択します。
. *新しいクローンを作成*を選択します。
. クローンの種類を選択します:
+
** *既存のスナップショットからのクローン作成とデータベースの更新*: クローンのスナップショットを選択し、クローンのオプションを構成します。これは、クローンのスナップショットを選択し、オプションを構成する場合に役立ちます。
** *インスタント スナップショットとクローン*: ソース データのスナップショットを今すぐ作成し、そのスナップショットからクローンを作成します。このオプションは、ソース ワークロードの最新データからクローンを作成する場合に便利です。


. *データベース ソース* セクションを完了します。
+
** *単一クローンまたは一括クローン*: 単一クローンを作成するか、複数クローンを作成するかを選択します。 *一括クローン*を選択すると、既に作成した保護グループを使用して一度に複数のクローンを作成できます。このオプションは、異なるワークロードに対して複数のクローンを作成する場合に便利です。
** *ソース データベース ホスト、インスタンス、および名前*: クローンのソース データベース ホスト、インスタンス、および名前を選択します。ソース データベースは、クローンの作成元となるデータベースです。


. *データベース ターゲット* セクションを完了します。
+
** *ターゲット データベース ホスト、インスタンス、および名前*: クローンのターゲット データベース ホスト、インスタンス、および名前を選択します。ターゲット データベースは、クローンが作成される場所です。
+
必要に応じて、ターゲット名のドロップダウン リストから *サフィックス* を選択し、クローンされたデータベース名にサフィックスを追加します。サフィックスを指定しない場合、クローンされたデータベース名はソース データベース名と同じになります。

** *QoS (最大スループット)*: クローンのサービス品質 (QoS) 最大スループットを MBps 単位で選択します。  QoS は、最大スループットや IOPS など、クローンのパフォーマンス特性を定義します。


. *マウント*セクションを完了します。
+
** *マウント ポイントの自動割り当て*: クローンのマウント ポイントを自動的に割り当てるには、このオプションを選択します。マウント ポイントは、オブジェクト ストア内でクローンがマウントされる場所です。
** *マウント ポイント パスの定義*: クローンのマウント ポイントを入力します。マウント ポイントは、オブジェクト ストア内でクローンがマウントされる場所です。ドライブ文字を選択し、データ ファイルのパスを入力し、ログ ファイルのパスを入力します。


. *次へ*を選択します。
. 復元ポイントを選択します:
+
** *既存のスナップショット*: ワークロードで使用可能なスナップショットのリストから既存のスナップショットを選択します。このオプションは、特定の時点からクローンを作成する場合に便利です。
** *インスタント スナップショットとクローン*: ワークロードで使用可能なスナップショットのリストから最新のスナップショットを選択します。このオプションは、ソース ワークロードの最新データからクローンを作成する場合に便利です。


. *インスタント スナップショットとクローン*の作成を選択した場合は、クローンの保存場所を選択します。
+
** *ローカル ストレージ*: ONTAPシステムのローカル ストレージにクローンを作成するには、このオプションを選択します。ローカル ストレージは、 ONTAPシステムに直接接続されたストレージです。
** *セカンダリ ストレージ*: ONTAPシステムのセカンダリ ストレージにクローンを作成するには、このオプションを選択します。セカンダリ ストレージは、バックアップおよびリカバリのワークロードに使用されるストレージです。


. データとログの保存先を選択します。
. *次へ*を選択します。
. *詳細オプション*セクションを完了します。
. *インスタント スナップショットとクローン* を選択した場合は、次のオプションを完了します。
+
** *クローンの更新スケジュールと有効期限*: *インスタントクローン* を選択した場合は、クローンの更新を開始する日付を入力します。クローン スケジュールは、クローンがいつ作成されるかを定義します。
+
*** *スケジュールの有効期限が切れたらクローンを削除*: クローンの有効期限が切れたらクローンを削除する場合。
*** *クローンの更新間隔*: クローンを更新する頻度を選択します。クローンを毎時、毎日、毎週、毎月、または四半期ごとに更新することを選択できます。このオプションは、クローンをソース ワークロードに合わせて最新の状態に保つ場合に便利です。


** *プレスクリプトとポストスクリプト*: オプションで、クローンの作成前と作成後に実行するクローン前スクリプトとクローン後スクリプトを指定します。これらのスクリプトは、クローンの構成や通知の送信などの追加タスクを実行するために使用できます。
** *通知*: オプションで、ジョブ レポートとともにクローン作成ステータスに関する通知を受信する電子メール アドレスを指定します。クローン作成ステータスに関する通知を受信するための Webhook URL を指定することもできます。成功通知と失敗通知の両方、またはどちらか一方のみの通知を指定することができます。
** *タグ*: 後でリソース グループを検索するときに役立つ 1 つ以上のラベルを選択し、[*適用*] を選択します。たとえば、複数のリソース グループに「HR」をタグとして追加すると、後で HR タグに関連付けられているすべてのリソース グループを見つけることができます。


. *作成*を選択します。
. クローンが作成されると、*インベントリ*ページで確認できます。




== クローンの更新

Microsoft SQL Server ワークロードのクローンを更新できます。クローンを更新すると、クローンはそのソース ワークロードの最新データで更新されます。これは、クローンをソース ワークロードに合わせて最新の状態に保つ場合に便利です。

データベース名を変更したり、最新のインスタント スナップショットを使用したり、既存の運用スナップショットから更新したりすることができます。

.手順
. NetApp のバックアップとリカバリ メニューから、*クローン* を選択します。
. 更新するクローンを選択します。
. アクションアイコンを選択しますimage:../media/icon-action.png["アクションオプション"]> *クローンを更新*。
. *詳細設定*セクションを完了します。
+
** *回復範囲*: すべてのログ バックアップを回復するか、特定の時点までのログ バックアップを回復するかを選択します。このオプションは、クローンを特定の時点に復元する場合に便利です。
** *クローンの更新スケジュールと有効期限*: *インスタントクローン* を選択した場合は、クローンの更新を開始する日付を入力します。クローン スケジュールは、クローンがいつ作成されるかを定義します。
+
*** *スケジュールの有効期限が切れたらクローンを削除*: クローンの有効期限が切れたらクローンを削除する場合。
*** *クローンの更新間隔*: クローンを更新する頻度を選択します。クローンを毎時、毎日、毎週、毎月、または四半期ごとに更新することを選択できます。このオプションは、クローンをソース ワークロードに合わせて最新の状態に保つ場合に便利です。


** *iGroup 設定*: クローンの igroup を選択します。 igroup は、クローンへのアクセスに使用されるイニシエーターの論理グループです。既存の igroup を選択するか、新しい igroup を作成することができます。プライマリまたはセカンダリONTAPストレージ システムから igroup を選択します。
** *プレスクリプトとポストスクリプト*: オプションで、クローンの作成前と作成後に実行するクローン前スクリプトとクローン後スクリプトを指定します。これらのスクリプトは、クローンの構成や通知の送信などの追加タスクを実行するために使用できます。
** *通知*: オプションで、ジョブ レポートとともにクローン作成ステータスに関する通知を受信する電子メール アドレスを指定します。クローン作成ステータスに関する通知を受信するための Webhook URL を指定することもできます。成功通知と失敗通知の両方、またはどちらか一方のみの通知を指定することができます。
** *タグ*: 後でリソース グループを検索するときに役立つ 1 つ以上のラベルを入力します。たとえば、複数のリソース グループに「HR」をタグとして追加すると、後で HR タグに関連付けられているすべてのリソース グループを見つけることができます。


. 続行するには、更新確認ダイアログボックスで「*更新*」を選択します。




== クローンの更新をスキップする

ソース ワークロードの最新データでクローンを更新したくない場合は、クローンの更新をスキップすることができます。クローンの更新をスキップすると、クローンを更新せずにそのまま維持できます。

.手順
. NetApp のバックアップとリカバリ メニューから、*クローン* を選択します。
. 更新をスキップするクローンを選択します。
. アクションアイコンを選択しますimage:../media/icon-action.png["アクションオプション"]> *更新をスキップ*。
. [更新をスキップする] 確認ダイアログ ボックスで、次の操作を行います。
+
.. 次の更新スケジュールのみをスキップするには、[*次の更新スケジュールのみをスキップ*] を選択します。
.. 続行するには、[スキップ] を選択します。






== クローンのスプリット

Microsoft SQL Server ワークロードのクローンを分割できます。クローンを分割すると、クローンから新しいバックアップが作成されます。新しいバックアップを使用してワークロードを復元できます。

クローンを独立したクローンまたは長期クローンとして分割することを選択できます。ウィザードには、SVM の一部であるアグリゲートのリスト、それらのサイズ、およびクローン ボリュームが存在する場所が表示されます。 NetApp Backup and Recovery は、クローンを分割するのに十分なスペースがあるかどうかも示します。クローンを分割すると、クローンはその保護のために独立したデータベースになります。

クローンジョブは削除されず、他のクローンに再度再利用できます。

.手順
. NetApp のバックアップとリカバリ メニューから、*クローン* を選択します。
. クローンを選択します。
. アクションアイコンを選択しますimage:../media/icon-action.png["アクションオプション"]> *分割クローン*。
. 分割クローンの詳細を確認し、「分割」を選択します。
. 分割クローンが作成されると、*インベントリ*ページで確認できます。




== クローンを削除する

Microsoft SQL Server ワークロードのクローンを削除できます。クローンを削除すると、オブジェクト ストアからクローンが削除され、ストレージ領域が解放されます。

クローン がポリシーによって保護されている場合、ジョブを含めてクローン が削除されます。

.手順
. NetApp のバックアップとリカバリ メニューから、*クローン* を選択します。
. クローンを選択します。
. アクションアイコンを選択しますimage:../media/icon-action.png["アクションオプション"]> *クローンを削除*。
. クローンの削除確認ダイアログボックスで、削除の詳細を確認します。
+
.. クローンまたはそのストレージにアクセスできない場合でも、クローンされたリソースをSnapCenterから削除するには、[強制削除] を選択します。
.. *削除*を選択します。


. クローンを削除すると、*インベントリ* ページから削除されます。

