---
sidebar: sidebar 
permalink: br-use-mssql-restore.html 
keywords: backing up, restoring, back up, backup, restore, cloud volumes ontap, aws, azure, s3, blob, google cloud, storagegrid, back up volumes, cloud backup, restore volumes, cost, on-premises ontap, onprem, applications, virtual machines, backup and recovery 
summary: スナップショット コピー、セカンダリ ストレージに複製されたワークロード バックアップ、またはオブジェクト ストレージに保存されたバックアップからデータベース ワークロードを復元します。 
---
= NetApp のバックアップとリカバリを使用して Microsoft SQL Server のワークロードを復元する
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
NetApp Backup and Recovery を使用して、スナップショット コピー、セカンダリ ストレージに複製されたワークロード バックアップ、またはオブジェクト ストレージに保存されたバックアップから Microsoft SQL Server ワークロードを復元します。ワークロードを元のシステム、同じクラウド アカウントを使用している別のシステム、またはオンプレミスのONTAPシステムに復元できます。

.これらの場所から復元
異なる開始場所からワークロードを復元できます。

* プライマリロケーションから復元
* 複製されたリソースから復元する
* オブジェクトストアのバックアップから復元する


.これらのポイントに復元する
データを最新のスナップショットまたは以下のポイントに復元できます。

* スナップショットからの復元
* 特定の時点に復元します。これは、ファイルの名前と場所、およびファイルが最後に良好な状態であった日付がわかっている場合に役立ちます。
* 最新のバックアップに復元する


.オブジェクトストレージからの復元に関する考慮事項
オブジェクト ストレージ内のバックアップ ファイルを選択し、そのバックアップに対して Ransomware Resilience がアクティブになっている場合 (バックアップ ポリシーで DataLock と Ransomware Resilience を有効にした場合)、データを復元する前に、バックアップ ファイルに対して追加の整合性チェックを実行するように求められます。スキャンを実行することをお勧めします。


TIP: バックアップ ファイルの内容にアクセスするには、クラウド プロバイダーから追加の送信コストが発生します。



== ワークロードの復元の仕組み

ワークロードを復元すると、次のことが起こります。

* バックアップ ファイルからワークロードを復元すると、 NetApp Backup and Recovery はバックアップのデータを使用して新しいリソースを作成します。
* 複製されたワークロードから復元する場合、ワークロードを元のシステムまたはオンプレミスのONTAPシステムに復元できます。
+
image:diagram_browse_restore_volume-unified.png["リソースを復元するフローを示す図"]

* オブジェクト ストレージからバックアップを復元する場合、データを元のシステムまたはオンプレミスのONTAPシステムに復元できます。




== 復元方法

次のいずれかの方法を使用してワークロードを復元できます。通常、復元のニーズに応じて次のいずれかの方法を選択します。

* *復元ページから*: リソースを復元する必要があるが、リソースの正確な名前や保存場所、またはリソースが最後に良好な状態であった日付を覚えていない場合に、これを使用します。フィルターを使用してスナップショットを検索できます。
* *インベントリ ページから*: 過去 1 週間または 1 か月間の特定のリソースを復元する必要がある場合、リソースの名前と場所、およびリソースが最後に良好な状態であった日付がわかっている場合にこれを使用します。リソースのリストを参照して、復元するリソースを見つけます。


*必要なNetAppコンソール ロール* ストレージ ビューアー、バックアップおよびリカバリ スーパー管理者、またはバックアップおよびリカバリ バックアップ管理者ロール。 https://docs.netapp.com/us-en/console-setup-admin/reference-iam-predefined-roles.html["すべてのサービスに対するNetAppコンソールのアクセスロールについて学習します"^] 。



== 復元オプションからワークロードデータを復元します

復元オプションを使用してデータベース ワークロードを復元します。

.手順
. NetApp のバックアップとリカバリ メニューから、[復元] を選択します。
. 復元するデータベースを選択します。フィルターを使用して検索します。
. 復元オプションを選択します:
+
** スナップショットからの復元
** 特定の時点に復元します。これは、ファイルの名前と場所、およびファイルが最後に良好な状態であった日付がわかっている場合に役立ちます。
** 最新のバックアップに復元する






=== スナップショットからワークロードを復元する

. 復元オプション ページから続行して、*スナップショットからの復元*を選択します。
+
スナップショットのリストが表示されます。

. 復元するスナップショットを選択します。
. *次へ*を選択します。
+
次に、宛先オプションが表示されます。

. 宛先の詳細ページで、次の情報を入力します。
+
** *宛先設定*: データを元の場所に復元するか、別の場所に復元するかを選択します。別の場所の場合は、ホスト名とインスタンスを選択し、データベース名を入力して、スナップショットを復元する宛先パスを入力します。
** *復元前のオプション*:
+
*** *復元中に同じ名前のデータベースを上書きする*: 復元中、元のデータベース名は保持されます。
*** *SQL データベースのレプリケーション設定を保持*: 復元操作後も SQL データベースのレプリケーション設定を保持します。
*** *復元前にトランザクション ログのバックアップを作成する*: 復元操作の前にトランザクション ログのバックアップを作成します。***  *復元前のトランザクション ログ バックアップが失敗した場合は復元を終了*: トランザクション ログ バックアップが失敗した場合は復元操作を停止します。
*** *Prescript*: 復元操作の前に実行するスクリプトの完全なパス、スクリプトが取る引数、およびスクリプトが完了するまでの待機時間を入力します。


** *復元後のオプション*:
+
*** *動作可能*ですが、追加のトランザクション ログを復元するためには使用できません。これにより、トランザクション ログ バックアップが適用された後、データベースがオンラインに戻ります。
*** *非動作*ですが、追加のトランザクション ログを復元するために使用できます。トランザクション ログ バックアップを復元しながら、復元操作後にデータベースを非動作状態に維持します。このオプションは、追加のトランザクション ログを復元するのに役立ちます。
*** *読み取り専用モード*で、追加のトランザクション ログを復元できます。データベースを読み取り専用モードで復元し、トランザクション ログ バックアップを適用します。
*** *Postscript*: 復元操作後に実行するスクリプトの完全なパスと、スクリプトが受け取る引数を入力します。




. *復元*を選択します。




=== 特定の時点に復元する

NetApp Backup and Recovery は、ログと最新のスナップショットを使用して、データのポイントインタイム リストアを作成します。

. 復元オプション ページから続行して、*特定の時点に復元*を選択します。
. *次へ*を選択します。
. 「特定の時点への復元」ページで、次の情報を入力します。
+
** *データ復元の日時*: 復元するデータの正確な日時を入力します。この日付と時刻は、Microsoft SQL Server データベース ホストからのものです。


. *検索*を選択します。
. 復元するスナップショットを選択します。
. *次へ*を選択します。
. 宛先の詳細ページで、次の情報を入力します。
+
** *宛先設定*: データを元の場所に復元するか、別の場所に復元するかを選択します。別の場所の場合は、ホスト名とインスタンスを選択し、データベース名を入力して、宛先パスを入力します。
** *復元前のオプション*:
+
*** *元のデータベース名を保持*: 復元中に、元のデータベース名が保持されます。
*** *SQL データベースのレプリケーション設定を保持*: 復元操作後も SQL データベースのレプリケーション設定を保持します。
*** *Prescript*: 復元操作の前に実行するスクリプトの完全なパス、スクリプトが取る引数、およびスクリプトが完了するまでの待機時間を入力します。


** *復元後のオプション*:
+
*** *動作可能*ですが、追加のトランザクション ログを復元するためには使用できません。これにより、トランザクション ログ バックアップが適用された後、データベースがオンラインに戻ります。
*** *非動作*ですが、追加のトランザクション ログを復元するために使用できます。トランザクション ログ バックアップを復元しながら、復元操作後にデータベースを非動作状態に維持します。このオプションは、追加のトランザクション ログを復元するのに役立ちます。
*** *読み取り専用モード*で、追加のトランザクション ログを復元できます。データベースを読み取り専用モードで復元し、トランザクション ログ バックアップを適用します。
*** *Postscript*: 復元操作後に実行するスクリプトの完全なパスと、スクリプトが受け取る引数を入力します。




. *復元*を選択します。




=== 最新のバックアップに復元する

このオプションは、最新の完全バックアップとログ バックアップを使用して、データを最後の正常な状態に復元します。システムは最後のスナップショットから現在までのログをスキャンします。このプロセスでは、変更とアクティビティを追跡して、データの最新かつ正確なバージョンを復元します。

. 復元オプション ページから続行して、*最新のバックアップに復元*を選択します。
+
NetApp Backup and Recovery では、復元操作に使用できるスナップショットが表示されます。

. 「最新の状態に復元」ページで、ローカル、セカンダリ ストレージ、またはオブジェクト ストレージのスナップショットの場所を選択します。
. *次へ*を選択します。
. 宛先の詳細ページで、次の情報を入力します。
+
** *宛先設定*: データを元の場所に復元するか、別の場所に復元するかを選択します。別の場所の場合は、ホスト名とインスタンスを選択し、データベース名を入力して、宛先パスを入力します。
** *復元前のオプション*:
+
*** *復元中に同じ名前のデータベースを上書きする*: 復元中、元のデータベース名は保持されます。
*** *SQL データベースのレプリケーション設定を保持*: 復元操作後も SQL データベースのレプリケーション設定を保持します。
*** *復元前にトランザクション ログ バックアップを作成する*: 復元操作の前にトランザクション ログ バックアップを作成します。
*** *復元前のトランザクション ログ バックアップが失敗した場合は復元を終了*: トランザクション ログ バックアップが失敗した場合は復元操作を停止します。
*** *Prescript*: 復元操作の前に実行するスクリプトの完全なパス、スクリプトが取る引数、およびスクリプトが完了するまでの待機時間を入力します。


** *復元後のオプション*:
+
*** *動作可能*ですが、追加のトランザクション ログを復元するためには使用できません。これにより、トランザクション ログ バックアップが適用された後、データベースがオンラインに戻ります。
*** *非動作*ですが、追加のトランザクション ログを復元するために使用できます。トランザクション ログ バックアップを復元しながら、復元操作後にデータベースを非動作状態に維持します。このオプションは、追加のトランザクション ログを復元するのに役立ちます。
*** *読み取り専用モード*で、追加のトランザクション ログを復元できます。データベースを読み取り専用モードで復元し、トランザクション ログ バックアップを適用します。
*** *Postscript*: 復元操作後に実行するスクリプトの完全なパスと、スクリプトが受け取る引数を入力します。




. *復元*を選択します。




== インベントリオプションからワークロードデータを復元する

インベントリ ページからデータベース ワークロードを復元します。インベントリ オプションを使用すると、インスタンスではなくデータベースのみを復元できます。

.手順
. NetAppバックアップおよびリカバリ メニューから、*インベントリ* を選択します。
. 復元するリソースが配置されているホストを選択します。
. *アクション*を選択しますimage:icon-action.png["アクションアイコン"]アイコンをクリックし、[詳細を表示] を選択します。
. Microsoft SQL Server ページで、*データベース* タブを選択します。
. [データベース] タブで、復元可能なバックアップがあることを示す「保護済み」ステータスが表示されているデータベースを選択します。
. *アクション*を選択しますimage:icon-action.png["アクションアイコン"]アイコンをクリックし、[復元] を選択します。
+
「復元」ページから復元する場合と同じ 3 つのオプションが表示されます。

+
** スナップショットからの復元
** 特定の時点に復元する
** 最新のバックアップに復元する


. 復元ページから復元オプションについて同じ手順を続行します。


ifdef::aws[]

endif::aws[]

ifdef::azure[]

endif::azure[]

ifdef::gcp[]

endif::gcp[]

ifdef::aws[]

endif::aws[]

ifdef::azure[]

endif::azure[]

ifdef::gcp[]

endif::gcp[]
